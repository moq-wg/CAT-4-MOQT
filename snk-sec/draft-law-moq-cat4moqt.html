<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Authentication scheme for MOQT using Common Access Tokens</title>
<meta content="Will Law" name="author">
<meta content="Chris Lemmons" name="author">
<meta content="Gwendal Simon" name="author">
<meta content="Suhas Nandakumar" name="author">
<meta content="
       A token-based authentication scheme for use with Media Over QUIC Transport. 
    " name="description">
<meta content="xml2rfc 3.30.1" name="generator">
<meta content="media over quic" name="keyword">
<meta content="authentication" name="keyword">
<meta content="common access token" name="keyword">
<meta content="CAT" name="keyword">
<meta content="draft-law-moq-cat4moqt-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.30.1
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.4.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-law-moq-cat4moqt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CAT-4-MOQT</td>
<td class="right">September 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Law, et al.</td>
<td class="center">Expires 20 March 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Media Over QUIC</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-law-moq-cat4moqt-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-09-16" class="published">16 September 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-03-20">20 March 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">W. Law</div>
<div class="org">Akamai</div>
</div>
<div class="author">
      <div class="author-name">C. Lemmons</div>
<div class="org">Comcast</div>
</div>
<div class="author">
      <div class="author-name">G. Simon</div>
<div class="org">Synamedia</div>
</div>
<div class="author">
      <div class="author-name">S. Nandakumar</div>
<div class="org">Cisco</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Authentication scheme for MOQT using Common Access Tokens</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">A token-based authentication scheme for use with Media Over QUIC Transport.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://wilaw.github.io/CAT-4-MOQT/draft-law-moq-cat4moqt.html">https://wilaw.github.io/CAT-4-MOQT/draft-law-moq-cat4moqt.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-law-moq-cat4moqt/">https://datatracker.ietf.org/doc/draft-law-moq-cat4moqt/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Media Over QUIC  mailing list (<span><a href="mailto:moq@ietf.org">mailto:moq@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/moq/">https://mailarchive.ietf.org/arch/browse/moq/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/moq/">https://www.ietf.org/mailman/listinfo/moq/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/wilaw/CAT-4-MOQT">https://github.com/wilaw/CAT-4-MOQT</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 20 March 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-overview-of-the-authenticat" class="internal xref">Overview of the authentication workflow</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-token-format" class="internal xref">Token format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-moqt-claim" class="internal xref">moqt claim</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-text-examples-of-permission" class="internal xref">Text examples of permissions to help with CDDL construction</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-multiple-actions" class="internal xref">Multiple actions</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-moqt-reval-claim" class="internal xref">moqt-reval claim</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-dpop-integration-with-cat-f" class="internal xref">DPoP Integration with CAT for MOQT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-cat-dpop-claims-for-moqt" class="internal xref">CAT DPoP Claims for MOQT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-key-benefits" class="internal xref">Key Benefits</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-confirmation-cnf-claim-with" class="internal xref">Confirmation (cnf) Claim with JWK Thumbprint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-common-access-token-dpop-se" class="internal xref">Common Access Token DPoP Settings (catdpop) Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#section-3.1.4" class="auto internal xref">3.1.4</a>.  <a href="#name-dpop-extension-with-applica" class="internal xref">DPoP Extension with Application-Agnostic Proof Framework</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.5">
                    <p id="section-toc.1-1.3.2.1.2.5.1"><a href="#section-3.1.5" class="auto internal xref">3.1.5</a>.  <a href="#name-moqt-resource-uri-construct" class="internal xref">MOQT Resource URI Construction</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-dpop-proof-process-and-toke" class="internal xref">DPoP Proof Process and Token Binding Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-phase-1-token-acquisition-w" class="internal xref">Phase 1: Token Acquisition with DPoP Binding</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-phase-2-moqt-operations-wit" class="internal xref">Phase 2: MOQT Operations with DPoP Proof Validation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-adding-a-token-to-a-url" class="internal xref">Adding a token to a URL</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This draft introduces a token-based authentication scheme for use with MOQT <span>[<a href="#MoQTransport" class="cite xref">MoQTransport</a>]</span>.
The scheme protects access to the relay during session establishment and also contrains the
actions which the client may take once connected.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This draft defines version 1 of this specification.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="overview-of-the-authentication-workflow">
<section id="section-1.1">
        <h3 id="name-overview-of-the-authenticat">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-overview-of-the-authenticat" class="section-name selfRef">Overview of the authentication workflow</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-1.1-1.1">
            <p id="section-1.1-1.1.1">An end-user logs-in to a distribution service. The service authenticates the user (via
username/password, OAuth, 2FA or another method). The methods involved in this authentication step
lie outside the scope of this draft.<a href="#section-1.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-1.2">
            <p id="section-1.1-1.2.1">Based upon the identity and permissions granted to that end-user, the service generates a token. A
token is a data structure that has been serialized into a byte array. The token encodes information
such as the user's ID, constraints on how and when they can access the MOQT distribution network and
contraints on the actions they can take once connected. The token may be signed to make it
tamper-resistent.<a href="#section-1.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-1.3">
            <p id="section-1.1-1.3.1">The token is given in the clear to the end-user, along with a URL to connect to the edge relay of a MOQT
distribution network. The edge relay is part of a trusted MOQT distribution network. It has previously
shared secrets with the distribution service, so that this relay is entitled to decrypt related tokens and
to validate signatures.<a href="#section-1.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-1.4">
            <p id="section-1.1-1.4.1">The end-user client application provides the token to the MOQT distribution relay when it connects. This
connection may be established over WebTransport or raw QUIC.<a href="#section-1.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-1.5">
            <p id="section-1.1-1.5.1">The relay decrypts the token upon receipt and validates the signature. Based upon claims conveyed in
the token, the relay accepts or rejects the connection.<a href="#section-1.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-1.6">
            <p id="section-1.1-1.6.1">If the relay accepts the connection, then the client will take a series of MOQT actions: ANNOUNCE,
SUBSCRIBE_ANNOUNCES, SUBSCRIBE or FETCH. For each of these, it will supply the token it received using
the AUTHENTICATION parameter.<a href="#section-1.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-1.7">
            <p id="section-1.1-1.7.1">As an alternative to this workflow, the distribution service may vend multiple tokens to the client. The
client may use one of those tokens to establish the initial conneciton and others to authenticate its actions.<a href="#section-1.1-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="token-format">
<section id="section-2">
      <h2 id="name-token-format">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-token-format" class="section-name selfRef">Token format</a>
      </h2>
<p id="section-2-1">This draft uses a single token format, namely the Common Access Token (CAT) <span>[<a href="#CAT" class="cite xref">CAT</a>]</span>. The token is supplied
as a byte array. When it must be cast to a string for inclusion in a URL, it is Base64 encoded <span>[<a href="#BASE64" class="cite xref">BASE64</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">To provide control over the MOQT actions, this draft defines a new CBOR Web Token (CWT) Claim called "moqt".
Use of the moqt claim is optional for clients. Support for processing the moqt claim is mandatory for relays.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The default for all actions is "Blocked" and this does not need to be communicated in the token.
As soon as a token is provided, all actions are explicitly blocked unless explicitly enabled.<a href="#section-2-3" class="pilcrow">¶</a></p>
<div id="moqt-claim">
<section id="section-2.1">
        <h3 id="name-moqt-claim">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-moqt-claim" class="section-name selfRef">moqt claim</a>
        </h3>
<p id="section-2.1-1">The "moqt" claim is defined by the following CDDL:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-2">
<pre>
$$Claims-Set-Claims //= (moqt-label =&gt; moqt-value)
moqt-label = TBD_MOQT
moqt-value = [ + moqt-scope ]
moqt-scope = [ moqt-actions, moqt-ns-match, moqt-track-match ]
moqt-actions = [ + moqt-action ]
moqt-action = int
moqt-ns-match = bin-match
moqt-track-match = bin-match

bin-match = {
  ? exact-match ^ =&gt; bstr,
  ? prefix-match ^ =&gt; bstr,
  ? suffix-match ^ =&gt; bstr,
  ? contains-match ^ =&gt; bstr,
}

/ match labels defined in CTA-5007-B 4.6.1 /
exact-match = 0
prefix-match = 1
suffix-match = 2
contains-match = 3
</pre><a href="#section-2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-2.1-3">The "moqt" claim bounds the scope of MOQT actions for which the token can provide
access. It is an array of action scopes. Each scope is an array with three
elements: an array of integers that identifies the actions, a match object for
the namespace, and a match object for the track name.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">The actions are integers defined as follows:<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Action</th>
              <th class="text-left" rowspan="1" colspan="1">Key</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CLIENT_SETUP</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#MoQTransport" class="cite xref">MoQTransport</a>]</span> Section 8.3</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SERVER_SETUP</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#MoQTransport" class="cite xref">MoQTransport</a>]</span> Section 8.3</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ANNOUNCE</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#MoQTransport" class="cite xref">MoQTransport</a>]</span> Section 8.23</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE_NAMESPACE</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#MoQTransport" class="cite xref">MoQTransport</a>]</span> Section 8.28</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#MoQTransport" class="cite xref">MoQTransport</a>]</span> Section 8.7</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE_UPDATE</td>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#MoQTransport" class="cite xref">MoQTransport</a>]</span> Section 8.10</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">PUBLISH</td>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#MoQTransport" class="cite xref">MoQTransport</a>]</span> Section 8.13</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">FETCH</td>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#MoQTransport" class="cite xref">MoQTransport</a>]</span> Section 8.16</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TRACK_STATUS</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#MoQTransport" class="cite xref">MoQTransport</a>]</span> Section 8.20</td>
            </tr>
          </tbody>
        </table>
<p id="section-2.1-6">The scope of the moqt claim is limited to the actions provided in the array.
Any action not present in the array is not authorized by moqt claim.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">The match object is defined to be a binary form of the match object defined in
<span>[<a href="#CAT" class="cite xref">CAT</a>]</span> Section 4.6.1. The regex and hash match types are not defined for use
with binary values in this document.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1-8">The first match operation is performed against the namespace and the second
against the track name (as defined in Section 2.4.1 of
{draft-ietf-moq-transport}). Since the match is not being performed against a
URI, no normalization is performed and the matches are performed against the
entire string. An empty match object is a legal construct that matches all
names.<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<div id="text-examples-of-permissions-to-help-with-cddl-construction">
<section id="section-2.1.1">
          <h4 id="name-text-examples-of-permission">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-text-examples-of-permission" class="section-name selfRef">Text examples of permissions to help with CDDL construction</a>
          </h4>
<p id="section-2.1.1-1">Example: Allow with an exact match "example.com/bob"<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.1-2">
<pre>
{
    /moqt/ TBD_MOQT: [[
        [ /ANNOUNCE/ 2, /SUBSCRIBE_NAMESPACE/ 3, /PUBLISH/ 6, /FETCH/ 7 ],
        { /exact/ 0: 'example.com'},
        { /exact/ 0: '/bob'}
    ]]
}
</pre><a href="#section-2.1.1-2" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-2.1.1-3">
<pre>
Permits
* 'example.com', '/bob'

Prohibits
* 'example.com', ''
* 'example.com', '/bob/123'
* 'example.com', '/alice'
* 'example.com', '/bob/logs'
* 'alternate/example.com', /bob
* '12345', ''
* 'example', '.com/bob'
</pre><a href="#section-2.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-2.1.1-4">Example: Allow with a prefix match "example.com/bob"<a href="#section-2.1.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.1-5">
<pre>
{
    /moqt/ TBD_MOQT: [[
        [ /ANNOUNCE/ 2, /SUBSCRIBE_NAMESPACE/ 3, /PUBLISH/ 6, /FETCH/ 7 ],
        { /exact/ 0: 'example.com'},
        { /prefix/ 1: '/bob'}
    ]]
}
</pre><a href="#section-2.1.1-5" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-2.1.1-6">
<pre>
Permits
* 'example.com', '/bob'
* 'example.com', '/bob/123'
* 'example.com', '/bob/logs'

Prohibits
* 'example.com', ''
* 'example.com', '/alice'
* 'alternate/example.com', '/bob'
* '12345', ''
* 'example', '.com/bob'
</pre><a href="#section-2.1.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="multiple-actions">
<section id="section-2.1.2">
          <h4 id="name-multiple-actions">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-multiple-actions" class="section-name selfRef">Multiple actions</a>
          </h4>
<p id="section-2.1.2-1">Multiple actions may be communicated within the same token, with different
permissions. This can be facilitated by the logical claims defined in
{draft-lemmons-composite-claims} or simply by defining multiple limits,
depending on the required restrictions. In both cases, the order in which
limits are declared and evaluated is unimportant. The evaluation stops after
the first acceptable result is discovered.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<div id="example-of-evaluating-multiple-actions-in-the-same-token">
<section id="section-2.1.2.1">
            <h5 id="name-example-of-evaluating-multi">
<a href="#section-2.1.2.1" class="section-number selfRef">2.1.2.1. </a><a href="#name-example-of-evaluating-multi" class="section-name selfRef">Example of evaluating multiple actions in the same token:</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-2.1.2.1-1">
<pre>
{
    /moqt/ TBD_MOQT: [
        [/PUBLISH/ 6, { /exact/ 0: 'example.com'}, { /prefix/ 1: 'bob'}],
        [/PUBLISH/ 6, { /exact/ 0: 'example.com'}, { /exact/ 0: 'logs/12345/bob'}]
    ],
    /exp/ 4: 1750000000
}
</pre><a href="#section-2.1.2.1-1" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-2.1.2.1-2.1">
                <p id="section-2.1.2.1-2.1.1">(1) PUBLISH (Allow with a prefix match) example.com/bob<a href="#section-2.1.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.1.2.1-2.2">
                <p id="section-2.1.2.1-2.2.1">(2) PUBLISH (Allow with an exact match) example.com/logs/12345/bob<a href="#section-2.1.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.1.2.1-3">Evaluating "example.com/bob/123" would succeed on test 1 and test 2 would never be evaluated.
Evaluating "example.com/logs/12345/bob" would fail on test 1 but then succeed on test 2.
Evaluating "example.com" would fail on test 1 and on test 2.<a href="#section-2.1.2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1.2.1-4">In addition, the entire token expires at 2025-05-02T21:57:24+00:00.<a href="#section-2.1.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-of-evaluating-multiple-actions-with-related-claims">
<section id="section-2.1.2.2">
            <h5 id="name-example-of-evaluating-multip">
<a href="#section-2.1.2.2" class="section-number selfRef">2.1.2.2. </a><a href="#name-example-of-evaluating-multip" class="section-name selfRef">Example of evaluating multiple actions with related claims:</a>
            </h5>
<p id="section-2.1.2.2-1">If there are other claims that depend on which MOQT limit applies, a logical claim is required:<a href="#section-2.1.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.2.2-2">
<pre>
{
    /or/ TBD_OR: [
        {
            /moqt/ TBD_MOQT: [[/PUBLISH/ 6, { /exact/ 0: 'example.com'}, { /prefix/ 1: 'bob'}]],
            /exp/ 4: 1750000000
        },
        {
            /moqt/ TBD_MOQT: [[/PUBLISH/ 6, { /exact/ 0: 'example.com'}, { /exact/ 0: 'logs/12345/bob'}]],
            /exp/ 4: 1750000600
        }
    ]
}
</pre><a href="#section-2.1.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.1.2.2-3">This provides access to the same tracks as the previous example, but in this
case, the token is valid for publishing logs up to 10 minutes after the time at
which the publishing of the bob track expires.<a href="#section-2.1.2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.1.2.2-4">DISCUSS: Because tokens are designed for instantanous evaluation, they
naturally only evaluate to an "acceptable" or an "unacceptable". It's somewhat
tricky to turn an evaluation into a complete bound on any particular value. The
CAT has a number of claims about the context of the request that can change
while the stream is open. The most obvious of these is the expiration time. The
"catnip" (Network IP) and geographic claims can also change mid-stream if the
connection is migrated or the client moves. Do we need to do something special
to require periodic re-evalution?<a href="#section-2.1.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="moqt-reval-claim">
<section id="section-2.2">
        <h3 id="name-moqt-reval-claim">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-moqt-reval-claim" class="section-name selfRef">moqt-reval claim</a>
        </h3>
<p id="section-2.2-1">The "moqt-reval" claim is defined by the following CDDL:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-2">
<pre>
$$Claims-Set-Claims //= (moqt-reval-label =&gt; moqt-reval-value)
moqt-reval-label = TBD_MOQT_REVAL
moqt-reval-value = number
</pre><a href="#section-2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.2-3">The "moqt-reval" claim indicates that the token must be
revalidated for ongoing streams. If the token is no longer acceptable, the
actions authorized by it <span class="bcp14">MUST</span> not be permitted to continue.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">The "moqt-reval-value" is a revalidation interval, expressed in seconds.
It provides an upper bound on how long a
token may be considered acceptable for an ongoing stream. A revalidator <span class="bcp14">MAY</span>
revalidate sooner.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">If the revalidation interval is smaller than the recipient is prepared
or able to revalidate, the recipient <span class="bcp14">MUST</span> reject the token. If a recipient is
unable to revalidate tokens, it <span class="bcp14">MUST</span> reject all tokens with a "moqt-reval"
claim.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">A token can be revalidated by simply validating it again, just as if it were
new. However, since some claims, signatures, MACs, and other attributes that
could contribute to unacceptability may be incapable of changing acceptability
in the duration, a revalidator may optimize by skipping some of the checks as
long as the outcome of the validation is the same. Revalidators <span class="bcp14">SHOULD</span> skip
reverifying MACs and signatures when the list of acceptable issuer keys is
unchanged.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<p id="section-2.2-7">When the value of this claim is zero, the token <span class="bcp14">MUST NOT</span> be revalidated. This
is the default behaviour when the claim is not present.<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<p id="section-2.2-8">This claim <span class="bcp14">MUST NOT</span> be used outside of a base claimset. If used within a composition
claims, the token is not well-formed.<a href="#section-2.2-8" class="pilcrow">¶</a></p>
<p id="section-2.2-9">The claim key for this claim is TBD_MOQT_REVAL and the claim value is a number.
Recipients <span class="bcp14">MUST</span> support this claim. This claim is <span class="bcp14">OPTIONAL</span> for issuers.<a href="#section-2.2-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dpop-integration-with-cat-for-moqt">
<section id="section-3">
      <h2 id="name-dpop-integration-with-cat-f">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dpop-integration-with-cat-f" class="section-name selfRef">DPoP Integration with CAT for MOQT</a>
      </h2>
<p id="section-3-1">This section defines the use of CAT's Demonstrating Proof of Possession (DPoP)
claims <span>[<a href="#DPoP" class="cite xref">DPoP</a>]</span> to enhance security in MOQT environments. This approach
leverages the CAT token's "cnf" (confirmation) claim with JWK Thumbprint
binding and the "catdpop" (CAT DPoP Settings) claim to provide
proof-of-possession capabilities that prevent token theft and replay
attacks in MOQT systems.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="cat-dpop-claims-for-moqt">
<section id="section-3.1">
        <h3 id="name-cat-dpop-claims-for-moqt">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-cat-dpop-claims-for-moqt" class="section-name selfRef">CAT DPoP Claims for MOQT</a>
        </h3>
<p id="section-3.1-1">CAT tokens used for MOQT <span class="bcp14">SHOULD</span> include DPoP-related claims as defined in
<span>[<a href="#CAT" class="cite xref">CAT</a>]</span> Section 4.8 to enable sender-constrained token usage. This proposal
extends the basic CAT authentication model by binding tokens to client
cryptographic key pairs, ensuring that only the legitimate token holder can
use the token for MOQT operations.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="key-benefits">
<section id="section-3.1.1">
          <h4 id="name-key-benefits">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-key-benefits" class="section-name selfRef">Key Benefits</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-3.1.1-1.1">
              <p id="section-3.1.1-1.1.1"><strong>Token Binding</strong>: CAT tokens are cryptographically bound to client key pairs<a href="#section-3.1.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.1-1.2">
              <p id="section-3.1.1-1.2.1"><strong>Replay Protection</strong>: Fresh DPoP proofs required for each MOQT action<a href="#section-3.1.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.1-1.3">
              <p id="section-3.1.1-1.3.1"><strong>Theft Prevention</strong>: Stolen tokens cannot be used without the corresponding
                      private key<a href="#section-3.1.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.1-1.4">
              <p id="section-3.1.1-1.4.1"><strong>Enhanced Trust</strong>: Relays can verify both token authenticity and
                    client possession<a href="#section-3.1.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="confirmation-cnf-claim-with-jwk-thumbprint">
<section id="section-3.1.2">
          <h4 id="name-confirmation-cnf-claim-with">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-confirmation-cnf-claim-with" class="section-name selfRef">Confirmation (cnf) Claim with JWK Thumbprint</a>
          </h4>
<p id="section-3.1.2-1">The CAT token <span class="bcp14">MUST</span> include a "cnf" claim with "jkt" (JWK Thumbprint)
confirmation method to enable DPoP binding<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">Below is an exmaple showing jkt token binding.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.2-3">
<pre>
{
  "cnf": {
    "jkt": &lt;32-byte JWK SHA-256 Thumbprint&gt;
  },
  "moqt": [
    [
      [2, 3, 6, 7], // ANNOUNCE, SUBSCRIBE_NAMESPACE, PUBLISH, FETCH
      {"exact": "cdn.example.com"},
      {"prefix": "/sports/"}
    ]
  ],
  "catdpop": {
    "0": 300,  // 5-minute window
    "1": 1     // Honor jti for replay protection
  },
  "exp": 1750000000
}
</pre><a href="#section-3.1.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.1.2-4">Implementation Requirements:<a href="#section-3.1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2-5.1">
              <p id="section-3.1.2-5.1.1">Relay Validation: MOQT relays <span class="bcp14">MUST</span> verify that DPoP proofs are signed with
the private key corresponding to the "jkt" value<a href="#section-3.1.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.2-5.2">
              <p id="section-3.1.2-5.2.1">Proof Binding: Relays <span class="bcp14">MUST</span> reject requests where DPoP proof validation or
key binding fails<a href="#section-3.1.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.2-5.3">
              <p id="section-3.1.2-5.3.1">Processing Semantics: Relays <span class="bcp14">MUST</span> process DPoP proofs as Protected Resource
Access requests per <span>[<a href="#DPoP" class="cite xref">DPoP</a>]</span> Section 7<a href="#section-3.1.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="common-access-token-dpop-settings-catdpop-claim">
<section id="section-3.1.3">
          <h4 id="name-common-access-token-dpop-se">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-common-access-token-dpop-se" class="section-name selfRef">Common Access Token DPoP Settings (catdpop) Claim</a>
          </h4>
<p id="section-3.1.3-1">The "catdpop" claim (key 321) provides essential processing parameters
for DPoP proof validation:<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3-2">Window Setting (key 0): Defines acceptable time window for DPoP proof validity
in seconds<a href="#section-3.1.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3-3.1">
              <p id="section-3.1.3-3.1.1">Type: Unsigned integer<a href="#section-3.1.3-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.3-3.2">
              <p id="section-3.1.3-3.2.1">Usage: Relays <span class="bcp14">MUST</span> use this value to validate DPoP proof timestamps<a href="#section-3.1.3-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.3-3.3">
              <p id="section-3.1.3-3.3.1">Example: 300 (5-minute acceptance window)<a href="#section-3.1.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.1.3-4">JTI Setting (key 1): Controls processing of "jti" claim in DPoP proofs for
replay protection<a href="#section-3.1.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3-5.1">
              <p id="section-3.1.3-5.1.1">Value 0: Ignore "jti" claims (no replay protection)<a href="#section-3.1.3-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.3-5.2">
              <p id="section-3.1.3-5.2.1">Value 1: Honor "jti" claims when available for replay protection<a href="#section-3.1.3-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.3-5.3">
              <p id="section-3.1.3-5.3.1">Default: 0 if not specified<a href="#section-3.1.3-5.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.1.3-6">Critical Setting (key -1): Array of setting keys that <span class="bcp14">MUST</span> be understood<a href="#section-3.1.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3-7.1">
              <p id="section-3.1.3-7.1.1">Type: Array of integers<a href="#section-3.1.3-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.3-7.2">
              <p id="section-3.1.3-7.2.1">Usage: Recipients <span class="bcp14">MUST</span> reject "catdpop" claim if they don't understand
listed critical settings<a href="#section-3.1.3-7.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.3-7.3">
              <p id="section-3.1.3-7.3.1">Restriction: <span class="bcp14">MUST NOT</span> contain -1, 0, or 1 (these are always required to
be understood)<a href="#section-3.1.3-7.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="dpop-extension-with-application-agnostic-proof-framework">
<section id="section-3.1.4">
          <h4 id="name-dpop-extension-with-applica">
<a href="#section-3.1.4" class="section-number selfRef">3.1.4. </a><a href="#name-dpop-extension-with-applica" class="section-name selfRef">DPoP Extension with Application-Agnostic Proof Framework</a>
          </h4>
<p id="section-3.1.4-1">This section defines the use of DPoP with an application-agnostic proof
framework as specified in <span>[<a href="#DPOP-PROOF" class="cite xref">DPOP-PROOF</a>]</span>, which
extends the traditional HTTP-centric DPoP model to support arbitrary
protocols including MOQT. This approach replaces HTTP-specific claims
with a flexible authorization context structure that can accommodate
protocol-specific command representations.<a href="#section-3.1.4-1" class="pilcrow">¶</a></p>
<p id="section-3.1.4-2">The DPoP proof JWT follows the structure defined in Section 4 of
<span>[<a href="#DPOP-PROOF" class="cite xref">DPOP-PROOF</a>]</span> with the following required claims:<a href="#section-3.1.4-2" class="pilcrow">¶</a></p>
<p id="section-3.1.4-3">JWT Header:<a href="#section-3.1.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.4-4.1">
              <p id="section-3.1.4-4.1.1">"typ": "dpop-proof+jwt"<a href="#section-3.1.4-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-4.2">
              <p id="section-3.1.4-4.2.1">"alg": Asymmetric signature algorithm identifier<a href="#section-3.1.4-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-4.3">
              <p id="section-3.1.4-4.3.1">"jwk": Public key for verification<a href="#section-3.1.4-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.1.4-5">JWT Payload:<a href="#section-3.1.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.4-6.1">
              <p id="section-3.1.4-6.1.1">"jti": Unique identifier for the JWT<a href="#section-3.1.4-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-6.2">
              <p id="section-3.1.4-6.2.1">"iat": Issued-at time<a href="#section-3.1.4-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-6.3">
              <p id="section-3.1.4-6.3.1">"actx": Authorization Context object<a href="#section-3.1.4-6.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.1.4-7">For MOQT operations, the Authorization Context ("actx") object contains:<a href="#section-3.1.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.4-8.1">
              <p id="section-3.1.4-8.1.1">"type": "moqt" (registered identifier for MOQT protocol)<a href="#section-3.1.4-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-8.2">
              <p id="section-3.1.4-8.2.1">"action": MOQT action identifier<a href="#section-3.1.4-8.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-8.3">
              <p id="section-3.1.4-8.3.1">"tns": Track namespace (required)<a href="#section-3.1.4-8.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-8.4">
              <p id="section-3.1.4-8.4.1">"tn": Track name (required)<a href="#section-3.1.4-8.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-8.5">
              <p id="section-3.1.4-8.5.1">"resource": MOQT resource identifier (optional)<a href="#section-3.1.4-8.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.1.4-9">When the optional "resource" parameter is included, it <span class="bcp14">MUST</span> be consistent with the
"tns" and "tn" parameters. The resource URI should follow the format
<code>moqt://&lt;relay-endpoint&gt;?tns=&lt;namespace&gt;&amp;tn=&lt;track&gt;</code> where the tns and tn query
parameters match the respective "tns" and "tn" fields in the Authorization Context.<a href="#section-3.1.4-9" class="pilcrow">¶</a></p>
<p id="section-3.1.4-10">Example DPoP proof for MOQT ANNOUNCE operation:<a href="#section-3.1.4-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.4-11">
<pre>
{
  "typ": "dpop-proof+jwt",
  "alg": "ES256",
  "jwk": { ... }
}
.
{
  "jti": "unique-request-id",
  "iat": 1705123456,
  "actx": {
    "type": "moqt",
    "action": "ANNOUNCE",
    "tns": "sports",
    "tn": "live-feed"
  }
}
</pre><a href="#section-3.1.4-11" class="pilcrow">¶</a>
</div>
<p id="section-3.1.4-12">MOQT action mapping for Authorization Context:<a href="#section-3.1.4-12" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
            <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">MOQT Action</th>
                <th class="text-left" rowspan="1" colspan="1">actx.action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CLIENT_SETUP</td>
                <td class="text-left" rowspan="1" colspan="1">SETUP</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SERVER_SETUP</td>
                <td class="text-left" rowspan="1" colspan="1">SETUP</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ANNOUNCE</td>
                <td class="text-left" rowspan="1" colspan="1">ANNOUNCE</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE_NAMESPACE</td>
                <td class="text-left" rowspan="1" colspan="1">SUB_NS</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE</td>
                <td class="text-left" rowspan="1" colspan="1">SUBSCRIBE</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">PUBLISH</td>
                <td class="text-left" rowspan="1" colspan="1">PUBLISH</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">FETCH</td>
                <td class="text-left" rowspan="1" colspan="1">FETCH</td>
              </tr>
            </tbody>
          </table>
<p id="section-3.1.4-14">Relays supporting this application-agnostic DPoP framework <span class="bcp14">MUST</span>:<a href="#section-3.1.4-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.4-15.1">
              <p id="section-3.1.4-15.1.1">Validate DPoP proofs according to <span>[<a href="#DPOP-PROOF" class="cite xref">DPOP-PROOF</a>]</span><a href="#section-3.1.4-15.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-15.2">
              <p id="section-3.1.4-15.2.1">Verify that the "actx.type" is "moqt" for MOQT operations<a href="#section-3.1.4-15.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-15.3">
              <p id="section-3.1.4-15.3.1">Validate that the "actx.action" matches the requested MOQT action<a href="#section-3.1.4-15.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-15.4">
              <p id="section-3.1.4-15.4.1">Verify that the "actx.tns" corresponds to the target track namespace<a href="#section-3.1.4-15.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-15.5">
              <p id="section-3.1.4-15.5.1">Verify that the "actx.tn" corresponds to the target track name<a href="#section-3.1.4-15.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-15.6">
              <p id="section-3.1.4-15.6.1">If present, verify the "actx.resource" is consistent with "tns" and "tn"<a href="#section-3.1.4-15.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.4-15.7">
              <p id="section-3.1.4-15.7.1">Reject requests where Authorization Context validation fails<a href="#section-3.1.4-15.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="moqt-resource-uri-construction">
<section id="section-3.1.5">
          <h4 id="name-moqt-resource-uri-construct">
<a href="#section-3.1.5" class="section-number selfRef">3.1.5. </a><a href="#name-moqt-resource-uri-construct" class="section-name selfRef">MOQT Resource URI Construction</a>
          </h4>
<p id="section-3.1.5-1">The Authorization Context "resource" field should specify track namespace (tns) and track name (tn) parameters for MOQT resources:<a href="#section-3.1.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5-2.1">
              <p id="section-3.1.5-2.1.1">Connection setup: <code>moqt://&lt;relay-endpoint&gt;</code><a href="#section-3.1.5-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.5-2.2">
              <p id="section-3.1.5-2.2.1">Namespace operations: <code>moqt://&lt;relay-endpoint&gt;?tns=&lt;namespace&gt;</code><a href="#section-3.1.5-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.5-2.3">
              <p id="section-3.1.5-2.3.1">Track operations: <code>moqt://&lt;relay-endpoint&gt;?tns=&lt;namespace&gt;&amp;tn=&lt;track&gt;</code><a href="#section-3.1.5-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="dpop-proof-process-and-token-binding-flow">
<section id="section-3.2">
        <h3 id="name-dpop-proof-process-and-toke">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-dpop-proof-process-and-toke" class="section-name selfRef">DPoP Proof Process and Token Binding Flow</a>
        </h3>
<p id="section-3.2-1">The following process illustrates how DPoP proof provision results in CAT
token binding and subsequent MOQT relay validation:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="phase-1-token-acquisition-with-dpop-binding">
<section id="section-3.2.1">
          <h4 id="name-phase-1-token-acquisition-w">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-phase-1-token-acquisition-w" class="section-name selfRef">Phase 1: Token Acquisition with DPoP Binding</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-3.2.1-1">
<pre>
┌──────────────┐                ┌─────────────────────┐                ┌──────┐
│MOQT Client   │                │Authorization Server │                │MOQT  │
│              │                │                     │                │Relay │
└──────┬───────┘                └──────────┬──────────┘                └──────┘
       │                                   │                                │
       │ (1) Generate Key Pair             │                                │
       │     EC P-256/RSA                  │                                │
       │     private_key, public_key       │                                │
       │                                   │                                │
       │ (2) Authentication Request        │                                │
       │     + User Credentials            │                                │
       │     + Public Key (JWK format)     │                                │
       ├──────────────────────────────────►│                                │
       │                                   │                                │
       │                                   │ (3) User Authentication        │
       │                                   │     &amp; Authorization            │
       │                                   │                                │
       │                                   │ (4) Generate CAT Token:        │
       │                                   │     • "cnf" claim with         │
       │                                   │       "jkt": SHA256(public_key)│
       │                                   │     • "catdpop" processing     │
       │                                   │       settings                 │
       │                                   │     • "moqt" action scope      │
       │                                   │     • Sign with shared secret  │
       │                                   │                                │
       │ (5) CAT Token Response            │                                │
       │     + Bound CAT Token             │                                │
       │     + Relay Endpoint URL          │                                │
       |◄──────────────────────────────────┤                                │
       │                                   │                                │
</pre><a href="#section-3.2.1-1" class="pilcrow">¶</a>
</div>
<p id="section-3.2.1-2">Steps 1-5 Detail:<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2.1-3">
<li id="section-3.2.1-3.1">
              <p id="section-3.2.1-3.1.1">Client Key Generation: The MOQT client generates an asymmetric key pair
(typically EC P-256) for DPoP operations<a href="#section-3.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-3.2">
              <p id="section-3.2.1-3.2.1">Authentication with Public Key: Client authenticates with the authorization
server, providing user credentials and the public key<a href="#section-3.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-3.3">
              <p id="section-3.2.1-3.3.1">User Authentication: Authorization server validates user identity and
permissions<a href="#section-3.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-3.4">
              <p id="section-3.2.1-3.4.1">CAT Token Generation: Server creates a CAT token containing:<a href="#section-3.2.1-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-3.4.2.1">
                  <p id="section-3.2.1-3.4.2.1.1">"cnf" claim: JWK Thumbprint ("jkt") of the client's public key
(32-byte SHA-256 hash)<a href="#section-3.2.1-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1-3.4.2.2">
                  <p id="section-3.2.1-3.4.2.2.1">"catdpop" claim: DPoP processing settings (window, jti handling,
critical settings)<a href="#section-3.2.1-3.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1-3.4.2.3">
                  <p id="section-3.2.1-3.4.2.3.1">"moqt" claim: Authorized MOQT actions and scope restrictions<a href="#section-3.2.1-3.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-3.2.1-3.5">
              <p id="section-3.2.1-3.5.1">Token Delivery: Server provides the bound CAT token and relay endpoint
information to the client<a href="#section-3.2.1-3.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="phase-2-moqt-operations-with-dpop-proof-validation">
<section id="section-3.2.2">
          <h4 id="name-phase-2-moqt-operations-wit">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-phase-2-moqt-operations-wit" class="section-name selfRef">Phase 2: MOQT Operations with DPoP Proof Validation</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-3.2.2-1">
<pre>
┌──────────────┐                ┌─────────────────────┐                ┌───────┐
│MOQT Client   │                │Authorization Server │                │MOQT   │
│              │                │                     │                │Relay  │
└──────┬───────┘                └──────────┬──────────┘                └──────┬┘
       │                                   │                                  │
       │                                   │                                  │
       │ (6) For each MOQT action:         │                                  │
       │     Create fresh DPoP proof JWT   │                                  │
       │     • Header: typ="dpop-proof+jwt"│                                  │
       │     •         alg, jwk            │                                  │
       │     • Claims: jti, iat, actx      │                                  │
       │     • Sign with private_key       │                                  │
       │                                   │                                  │
       │ (7) MOQT Request                  │                                  │
       │     + CAT Token                   │                                  │
       │     + Fresh DPoP Proof            │                                  │
       │     (CLIENT_SETUP, ANNOUNCE,      │                                  │
       │      SUBSCRIBE, PUBLISH, FETCH)   │                                  │
       ├─────────────────────────────────────────────────────────────────────►│
       │                                   │                                  │
       │                                   │                               (8)│
       │                                   │                   CAT Validation:│
       │                                   │                  • Verify token  │
       │                                   │                    signature     │
       │                                   │                  • Check exp     │
       │                                   │                  • Validate moqt │
       │                                   │                    claim scope   │
       │                                   │                                  │
       │                                   │                               (9)│
       │                                   │                 DPoP Validation: │
       │                                   │                  • Extract "jkt" │
       │                                   │                    from token    │
       │                                   │                  • Verify DPoP   │
       │                                   │                    JWT signature │
       │                                   │                  • Validate key  │
       │                                   │                    binding       │
       │                                   │                  • Check         │
       │                                   │                    freshness     │
       │                                   │                                  │
       │                                   │                              (10)│
       │                                   │              Action Authorization│
       │                                   │                  • Match action  │
       │                                   │                    to token scope│
       │                                   │                  • Check ns/track│
       │                                   │                    permissions   │
       │                                   │                                  │
       │ (11) Response                     │                                  │
       │      Success/Error                │                                  │
       ◄─────────────────────────────────────────────────────────────────────┤
       │                                   │                                  │
</pre><a href="#section-3.2.2-1" class="pilcrow">¶</a>
</div>
<p id="section-3.2.2-2">Steps 6-11 Detail:<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2.2-3">
<li id="section-3.2.2-3.1">
              <p id="section-3.2.2-3.1.1">DPoP Proof Creation: For each MOQT action, the client creates a fresh
  DPoP proof JWT with:<a href="#section-3.2.2-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-3.1.2.1">
                  <p id="section-3.2.2-3.1.2.1.1">Header: <code>typ: "dpop-proof+jwt"</code>, <code>alg</code>, <code>jwk</code> (public key)<a href="#section-3.2.2-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.1.2.2">
                  <p id="section-3.2.2-3.1.2.2.1">Claims: <code>jti</code> (unique ID), <code>iat</code> (timestamp), <code>actx</code>
        (Authorization Context with type, action, tns, tn)<a href="#section-3.2.2-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-3.2.2-3.2">
              <p id="section-3.2.2-3.2.1">MOQT Request: Client sends MOQT action with both CAT token and fresh DPoP
  proof<a href="#section-3.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.2-3.3">
              <p id="section-3.2.2-3.3.1">CAT Token Validation: Relay validates:<a href="#section-3.2.2-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-3.3.2.1">
                  <p id="section-3.2.2-3.3.2.1.1">Token signature using shared secret with authorization server<a href="#section-3.2.2-3.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.3.2.2">
                  <p id="section-3.2.2-3.3.2.2.1">Token expiration time<a href="#section-3.2.2-3.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.3.2.3">
                  <p id="section-3.2.2-3.3.2.3.1">"moqt" claim scope for requested action<a href="#section-3.2.2-3.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-3.2.2-3.4">
              <p id="section-3.2.2-3.4.1">DPoP Proof Validation: Relay performs:<a href="#section-3.2.2-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-3.4.2.1">
                  <p id="section-3.2.2-3.4.2.1.1">Extract "jkt" (JWK Thumbprint) from CAT token's "cnf" claim<a href="#section-3.2.2-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.4.2.2">
                  <p id="section-3.2.2-3.4.2.2.1">Verify DPoP JWT signature using embedded public key<a href="#section-3.2.2-3.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.4.2.3">
                  <p id="section-3.2.2-3.4.2.3.1">Confirm that SHA-256 hash of DPoP public key matches "jkt" value<a href="#section-3.2.2-3.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.4.2.4">
                  <p id="section-3.2.2-3.4.2.4.1">Check proof freshness within "catdpop" window settings<a href="#section-3.2.2-3.4.2.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.4.2.5">
                  <p id="section-3.2.2-3.4.2.5.1">Process replay protection based on "jti" settings<a href="#section-3.2.2-3.4.2.5.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.4.2.6">
                  <p id="section-3.2.2-3.4.2.6.1">Validate Authorization Context ("actx") according to <span>[<a href="#DPOP-PROOF" class="cite xref">DPOP-PROOF</a>]</span><a href="#section-3.2.2-3.4.2.6.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.4.2.7">
                  <p id="section-3.2.2-3.4.2.7.1">Verify "actx.type" is "moqt"<a href="#section-3.2.2-3.4.2.7.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.4.2.8">
                  <p id="section-3.2.2-3.4.2.8.1">Validate "actx.action" matches the requested MOQT action<a href="#section-3.2.2-3.4.2.8.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.2-3.4.2.9">
                  <p id="section-3.2.2-3.4.2.9.1">Verify "actx.tns" and "actx.tn" correspond to target resources<a href="#section-3.2.2-3.4.2.9.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-3.2.2-3.5">
              <p id="section-3.2.2-3.5.1">Action Authorization: Relay validates the specific MOQT action against
token scope and namespace/track permissions<a href="#section-3.2.2-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.2-3.6">
              <p id="section-3.2.2-3.6.1">Response: Relay responds with success or appropriate error information<a href="#section-3.2.2-3.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="adding-a-token-to-a-url">
<section id="section-4">
      <h2 id="name-adding-a-token-to-a-url">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-adding-a-token-to-a-url" class="section-name selfRef">Adding a token to a URL</a>
      </h2>
<p id="section-4-1">Any time an application wishes to add a CAT token to a URL or path element, the token <span class="bcp14">SHOULD</span> first
be Base64 encoded <span>[<a href="#BASE64" class="cite xref">BASE64</a>]</span>. The syntax and method of modifying the URL is left to the application
to define and is not constrained by this specification.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-5">
      <h2 id="name-conventions-and-definitions">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-5-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">TODO Add security considerations for DPoP Claims<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">IANA will register the following claims in the "CBOR Web Token (CWT) Claims" registry:<a href="#section-7-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
        <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1"> </th>
            <th class="text-left" rowspan="1" colspan="1">moqt</th>
            <th class="text-left" rowspan="1" colspan="1">moqt-reval</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Claim Name</td>
            <td class="text-left" rowspan="1" colspan="1">moqt</td>
            <td class="text-left" rowspan="1" colspan="1">moqt-reval</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Claim Description</td>
            <td class="text-left" rowspan="1" colspan="1">MOQT Action</td>
            <td class="text-left" rowspan="1" colspan="1">MOQT revalidation</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">JWT Claim Name</td>
            <td class="text-left" rowspan="1" colspan="1">N/A</td>
            <td class="text-left" rowspan="1" colspan="1">N/A</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Claim Key</td>
            <td class="text-left" rowspan="1" colspan="1">TBD_MOQT (1+2)</td>
            <td class="text-left" rowspan="1" colspan="1">TBD_MOQT (1+2)</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Claim Value Type</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">number</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Change Controller</td>
            <td class="text-left" rowspan="1" colspan="1">IESG</td>
            <td class="text-left" rowspan="1" colspan="1">IESG</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Specification Document</td>
            <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
            <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
          </tr>
        </tbody>
      </table>
<p id="section-7-3">[RFC Editor: Please replace RFCthis with the published RFC number for this
document.]<a href="#section-7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-normative-references">
<section id="section-8">
      <h2 id="name-normative-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="BASE64">[BASE64]</dt>
      <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CAT">[CAT]</dt>
      <dd>
<span class="refTitle">"CTA 5007-A Common Access Token"</span>, <time datetime="2024-12" class="refDate">December 2024</time>, <span>&lt;<a href="https://shop.cta.tech/products/cta-5007">https://shop.cta.tech/products/cta-5007</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DPoP">[DPoP]</dt>
      <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">D. Waite</span>, <span class="refTitle">"OAuth 2.0 Demonstrating Proof of Possession (DPoP)"</span>, <span class="seriesInfo">RFC 9449</span>, <span class="seriesInfo">DOI 10.17487/RFC9449</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9449">https://www.rfc-editor.org/rfc/rfc9449</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DPOP-PROOF">[DPOP-PROOF]</dt>
      <dd>
<span class="refAuthor">Nandakumar, S.</span>, <span class="refTitle">"Application-Agnostic Demonstrating Proof-of-Possession"</span>, <time datetime="2024-12" class="refDate">December 2024</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-nandakumar-oauth-dpop-proof-00.txt">https://www.ietf.org/archive/id/draft-nandakumar-oauth-dpop-proof-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MoQTransport">[MoQTransport]</dt>
      <dd>
<span class="refAuthor">Nandakumar, S.</span>, <span class="refAuthor">Vasiliev, V.</span>, <span class="refAuthor">Swett, I.</span>, and <span class="refAuthor">A. Frindell</span>, <span class="refTitle">"Media over QUIC Transport"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-moq-transport-13</span>, <time datetime="2025-07-07" class="refDate">7 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-moq-transport-13">https://datatracker.ietf.org/doc/html/draft-ietf-moq-transport-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">The IETF moq workgroup<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Will Law</span></div>
<div dir="auto" class="left"><span class="org">Akamai</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wilaw@akamai.com" class="email">wilaw@akamai.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chris Lemmons</span></div>
<div dir="auto" class="left"><span class="org">Comcast</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Chris_Lemmons@comcast.com" class="email">Chris_Lemmons@comcast.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Gwendal Simon</span></div>
<div dir="auto" class="left"><span class="org">Synamedia</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gsimon@synamedia.com" class="email">gsimon@synamedia.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Suhas Nandakumar</span></div>
<div dir="auto" class="left"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:snandaku@cisco.com" class="email">snandaku@cisco.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
